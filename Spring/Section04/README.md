# Section 04

한 달 전, 스프링부트입문강의를 들으며 스프링을 처음 배울 때에는, 웹 개발에 대한 이해 자체도 많이 부족해서 스프링이 어마어마하게 어려운, 다루기 힘든 툴이라는 느낌이었습니다. 압도당하면 금세 기가 죽는 편인터라, 더 조급한 마음으로 한달간 JSP와 웹 개발 학원에서 진행 내용을 배운 지금은 "하나의 프레임워크구나"하는 생각이 강하게 듭니다.  
REST api로 주고 받는 프로젝트를 시작하기 이전에, 스프링을 70% 정도는 이해하고 들어가고자 하는 마음에 서둘러 공부하고 있습니다. 한 달 전과 비교하여 마음가짐부터 실력, 기본적인 이해도까지, 눈에 띄게 성장한게 보여서 다행입니다.  

### Configuration, Bean

`@Configuration`, `@Bean` 어노테이션을 사용하여 기존의 자바 코드들에 스프링을 붙이기 시작했습니다. `AnnotationconfigApplicationContext` 클래스에 `AppConfig.class`를 파라미터로 넘겨주며 스프링 컨테이너를 생성하는 것을 시작으로, 기존의 코드를 스프링으로 바꾸어주었습니다.  

### 스프링 빈의 의존관계?
스프링 빈의 의존관계는 생성자를 호출하면서 함께 주입도 이루어지고 있습니다. 말이 **주입**이어서 어렵다뿐이지, 부모-자식의 관계라고 해야 할까요? 일종의 참조 관계, 위계 관계? 인터페이스와 구현체의 관계가 어떻게 이루어지고 있는 지에 대한 구체적인 정보를 넘겨주고 있는 듯 합니다. 이러한 구체적인 정보를 다시 말해 **참조를 넘겨준다**고 표현하고 있고요. 구현체A는 interfaceA를 참조하고 있고(==바라보고 있고==의존하고 있고), AppConfig 클래스에서 구체적인 구현 객체를 `new`로 만들어서 그 **참좃값을 넘겨주고** 있기 때문에, **참조를 넘겨준다**고 표현하는 듯 합니다.  

### 빈의 등록과 조회
이렇게 빈을 만들어보고, 빈들을 조회해보았습니다. 내가 **등록한** 빈이 무엇이 있는지 출력해볼 수 있었고(`getRole()`, `ROLE_APPLICATION`), `getBean()` 메소드를 이용해 빈을 조회해볼 수 있었습니다. 특히 `getBean()`은 `getBean(name)`, `getBean(type)`, `getBean(name, type)`으로 세 가지 매개변수가 있는데, name만을 이용해서 조회하려면 빈의 이름을 알아야 한다는 단점이 있습니다. 그렇다고 type(=빈이 상속받은 인터페이스!)만을 이용해서 조회하려면, 같은 타입의 빈이 여러 개일 경우에는 중복 오류가 발생합니다. 이 경우에는 이름도 함께 넣어서 조회해주어야 합니다.  

### 스프링 컨테이너 최상위 클래스 BeanFactory
빈을 관리하고 조회하는 인터페이스는 스프링 컨테이너의 최상위 클래스인 **BeanFactory**입니다. 해당 인터페이스로부터 `getBean()`을 상속받아 사용할 수 있구요. `AnnotationConfigApplicationContext`의 상위 인터페이스는 `ApplicationContext`가 있습니다. BeanFactory가 빈 조회와 관리를 제공해주긴 하지만, 그 외의 부가적인 기능은 ApplicationContext가 담당하고 있습니다. 메세지소스를 활용한 국제화 기능, 환경변수 설정 등을 해당 인터페이스에서 제공합니다. 이때, 환경변수 설정이란 로컬개발환경, 테스트서버환경(=개발환경), 운영환경, 추가로 staging환경(운영환경과 비슷하게 만들어둔 개발환경) 등을 설정하는 것을 의미하는데, 가령 환경마다 사용하는 DB가 다르고 사용하는 무언가의 버전이 다르고 등등을 설정해줍니다.  

### AppConfig XML
추가적으로 AppConfig 클래스를 xml파일로도 만들어보았습니다. 만드는 법까지는 외울(?) 필요가 없지만, 레거시 프로젝트 등에서는 쓰이고 있을 수 있으니 읽는 법은 알아야겠습니다.

### BeanDefinition
BeanDefinition 이라는 추상화로 스프링은 xml, class 등 다양한 설정 형식을 지원합니다. 어떤 설정 파일을 만들건간에, BeanDefinition 인터페이스를 받아 만들어지고 있는 듯 합니다.